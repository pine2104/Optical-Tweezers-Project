clc;clear;close all
A0=[31.65857
31.37354
32.89619
27.90481
32.79784
30.69654
32.14849
29.08421
35.37232
29.30907
17.57059
29.87656
32.2434
30.84973
35.47498
33.06681
24.76575
31.98533
34.87877
30.6509
29.20699
34.77905
34.06804
35.56201
32.00139
30.38732
34.17617
34.9624
22.03123
30.32171
27.99254
33.47042
36.54207
29.74389
29.00953
32.90347
24.09846
34.40778
33.70152
28.15958
32.78062
32.77301
35.71549
31.85284
30.19661
31.58789
33.71185
37.59629
30.40509
33.83234
33.56464
35.83501
36.82173
22.34298
34.54734
33.43334
35.6191
38.68705
35.72996
38.29062
34.80033
33.80352
34.06155
36.73876
35.11052
37.21766
36.01833
34.81461
34.91647
33.57888
35.19658
38.23414
36.24507
36.24743
37.8926
46.29277
34.26169
35.46388
33.20413
35.16598
36.58169
28.31274
33.73755
39.8472
34.49612
31.98058
34.2879
35.54581
35.50506
34.04919
35.35658
23.98953
34.3982
18.83325
37.37977
37.66096
36.84497
16.91052
38.85329
35.7015
36.7637
35.58445
35.8966
43.73845
42.7022
38.03246
41.88458
40.70733
44.93688
35.87385
43.24227
44.3868
35.68826
16.33404
16.33404
51.92826
44.04667
43.96419
34.97325
36.84711
31.65857
31.37354
32.89619
27.90481
32.79784
30.69654
32.14849
29.08421
35.37232
29.30907
17.57059
29.87656
32.2434
30.84973
35.47498
33.06681
24.76575
31.98533
34.87877
30.6509
29.20699
34.77905
34.06804
35.56201
32.00139
30.38732
34.17617
34.9624
22.03123
30.32171
27.99254
33.47042
36.54207
29.74389
29.00953
32.90347
24.09846
34.40778
33.70152
28.15958
32.78062
32.77301
35.71549
31.85284
30.19661
31.58789
33.71185
37.59629
30.40509
33.83234
33.56464
35.83501
36.82173
22.34298
34.54734
33.43334
35.6191
38.68705
35.72996
38.29062
34.80033
33.80352
34.06155
36.73876
35.11052
37.21766
36.01833
34.81461
34.91647
33.57888
35.19658
38.23414
36.24507
36.24743
37.8926
46.29277
34.26169
35.46388
33.20413
35.16598
36.58169
28.31274
33.73755
39.8472
34.49612
31.98058
34.2879
35.54581
35.50506
34.04919
35.35658
23.98953
34.3982
18.83325
37.37977
37.66096
36.84497
16.91052
38.85329
35.7015
36.7637
35.58445
35.8966
43.73845
42.7022
38.03246
41.88458
40.70733
44.93688
35.87385
43.24227
44.3868
35.68826
16.33404
16.33404
51.92826
44.04667
43.96419
34.97325
36.84711
36.20105
39.92168
35.06247
50.15934
37.85709
35.17915
36.68503
35.24929
33.77584
37.42175
34.50235
39.61536
39.18425
37.86872
2.99925
25.78996
34.50658
37.15597
37.9498
35.84537
37.46264
35.73716
39.16169
35.93209
38.38584
2.99925
31.36016
37.33751
38.28397
40.32494
37.99034
40.86673
39.44651
38.60721
39.45779
33.03348
36.62123
35.1164
39.51031
41.90344
43.98319
21.31321
37.06784
37.41647
56.63265
37.35936
30.67103
38.32909
40.1501
35.9275
31.7391
36.46154
37.41893
19.02196
43.01875
38.76619
38.60404
39.08026
41.29608
37.26912
37.5839
37.76544
35.01982
38.13345
38.99144
32.51248
40.60342
34.69129
38.0559
36.22114
36.81228
38.46269
18.42095
4.2987
34.58307
36.37306
4.2987
35.11323
37.24409
37.63079
29.98753
35.78227
39.68621
38.83387
38.16905
36.17108
39.05524
40.34222
42.23232
14.8681
33.80334
41.35283
39.46907
39.64638
37.65158
20.51761
36.62334
39.3531
13.08163
39.47683
37.41999
35.74385
37.77919
38.78346
34.30882
33.81603
9.66837
33.82484
19.92154
36.63568
32.42048
37.01391
33.57774
32.70777
36.53134
38.14614
20.04914
35.91411
23.29244
37.6681
34.69197
33.87345
34.45128
39.20728
40.04755
28.36998
39.08765
37.57131
35.53007
27.5935
92.336
40.00079
38.24012
14.00193
38.08787
38.04583
34.14097
35.55001
35.72003
35.7947
36.59764
34.63833
16.80985
39.12499
29.31356
25.62114
37.06599
41.75166
26.75794
30.7719
33.1847
34.77499
37.96789
33.25394
64.21905
35.43474
38.86399
36.98189
35.07478
31.01151
35.70951
29.73298
35.78745
37.51839
23.40771
32.23096
36.74372
31.12389
39.97288
36.46641
32.33427
40.99259
35.14728
30.21256
40.05262
35.3191
30.39599
36.70893
28.17676
15.14561
36.08543
34.38023
36.15829
24.18274
15.13401
38.1843
34.41503
36.19309
31.87173
29.38824
36.7807
36.63316
32.62246
38.0944
37.09607
32.86353];
A4=[32.17858
4.87315
33.25684
29.8876
28.22776
11.66213
28.31613
27.05302
32.65954
31.26101
30.04281
27.79307
30.17851
12.63443
31.23648
24.08874
29.44828
13.76384
31.47515
29.202
30.81761
35.07191
33.21265
32.78127
32.59692
31.44705
34.46977
33.39117
31.57077
32.44709
32.64616
34.4457
33.27519
32.94071
8.54881
39.00644
36.46728
33.72923
32.06457
30.13497
30.78711
34.54789
31.94447
32.40095
29.51936
37.22699
29.07156
28.43447
34.20378
15.5308
32.61575
33.95504
32.49934
34.63769
32.42983
36.48394
35.81439
22.59146
35.48829
27.86295
33.2631
17.78917
36.26729
33.381
28.31867
32.94046
35.35017
33.00805
34.56382
37.08896
32.93612
34.1222
31.00645
34.87901
37.89157
38.41611];
B8=[32.14729
30.33831
33.04008
10.42548
37.25615
27.24004
32.29119
29.57201
30.4674
34.73556
32.99701
5.82871
32.12509
32.61446
31.99612
32.07485
5.14274
22.25079
31.27477
30.49599
32.53039
32.04201
36.71578
30.73811
32.54413
29.88707
32.36697
31.15716
16.08508
30.59429
12.62868
27.03851
31.46671
33.27973
31.05916
27.77611
28.36022
30.78057
34.59851
33.5686
26.27272
9.64198
37.33996
36.43256
31.47303
31.75491
10.35871
29.5378
6.78209
6.78209
35.59268
11.54098
32.81665
33.49591
24.42003
30.10892
37.6
14.34034
36.58017
33.45887
22.10884
32.84028
32.59774
32.31602
28.70675
8.93954
32.3094
9.47526
14.59226
35.04683
35.83929
28.28986
33.36905
39.05531
33.80779
33.12132
32.52416
41.55808
33.84777
36.27208
37.72846
36.82869
36.54247
19.53422
43.26026
37.25005
32.17856
36.55509
19.34171
35.05111
36.58242
37.09452
31.42158
38.03298
19.50928
36.7983
35.06888
41.22511
18.96405
35.72519
19.10753
36.32269
26.97095
33.48415
32.77649
29.16689
33.02458
29.8853
33.44425
27.46355
28.34758
31.77097
32.30991
34.70453
31.61501
30.98258
31.75904
33.43779
8.34261
31.8437
30.87449
35.68753
32.29414
32.08522
30.88874
40.72535
37.88319
22.51838
38.57428
22.32279
22.45572
41.20189
40.51748
34.59125
22.45572];
C15=[21.71593
39.2851
21.71593
32.22795
38.63901
41.97913
39.0757
42.36368
24.37005
39.13216
38.14149
39.57635
36.28302
40.09448
39.87416
37.16256
39.92111
39.24031
22.93366
22.82097
36.80456
36.17639
24.84582
38.29287
25.08344
37.72819
33.53291
29.92341
35.15885
28.56514
38.85139
34.76047
27.69164
30.0056
31.85859
32.94581
36.5845
34.33322
34.28486
34.8597
24.42388
26.46371
32.09706
38.17942
32.59526
34.16119
35.86783
31.30253
13.8459
37.79741
38.57471
32.73514
35.36969
34.78129
40.86578
38.14564
32.60152
24.69229
34.02006
35.49072
21.28918
31.69063
30.5008
17.33056
32.46706
31.04464
15.14453
26.22654
29.62786
24.75946
31.29699
20.9808
36.95356
32.90656
34.61609
16.61487
29.44375
29.70199
26.3518
30.0627
17.9876];
D30=[32.74889
32.74889
39.25419
32.0025
35.73028
33.00702
26.69557
39.03824
14.03047
19.17081
36.8524
23.09199
8.72848
31.92218
35.51398
35.06892
41.6026
29.43319
32.6616
17.15297
36.77285
27.88852
36.11629
8.30327
31.92306
24.52167
34.01843
26.43638
24.46143
15.78192
32.31015
20.9492
17.18563
5.75519
32.23685
23.18364
18.47137
7.58945
27.98077
15.53971
32.45055
8.87054
31.22957
25.93742
29.6101
34.64777
19.95452
38.75391
24.96997
36.46812
12.01406
19.76472
8.34723
25.27411
34.34021
8.47674
32.26206
36.24105
22.38936
32.84914
21.18357
29.19197
24.65534
6.42574
7.02498
7.50678
6.17695
9.25422
8.36034
40.19391
37.13755
30.04879
21.04791
27.29826
17.16012
11.7599
7.04923
6.6517
5.65975
5.97153
8.65072
6.10378
8.73051
36.6321
7.94428
8.66156
35.04308
39.06177
28.93025
10.64588
8.79844
19.88615
36.69628
35.11492
31.88509
11.22836
35.22416
32.28443
7.71202
11.10733
7.12365
7.46229
20.93546
];
E60=[33.52582
12.24418
28
15
22.68615
24.88647
18.15929
11.31677
24.91996
14.26433
14.43262
24.3
23.44696
25.90435
31.40453
9.28632
8.90161
5.10835
35
10.35476
10.48431
5.10712
14.96708
7.88399
8.11064
7.54237
7.37761
31.06269
4.28709
7.66651
7.44362
7.6
7.57253
15
4.28403
9.18782
32.8
7.25294
7.29242
7.23618
7.53744
7.89767
7.42308
33.26282
7.37152
33.26282
12.24418
6.40863
5.86906
16.48848
11.25428
8.72061
12.87746
14
46.85675
35.6207
38.1031
35.94622
34.41466
43.67219
39.47589
35.18171
31.5694
30.97526
36.08361
43.46991
28.04662
31.18696
29.67534
17.33874];

beginA0=0;   % fit one gauss
binsizeA0=2.2;
endA0=101.2;
[cA0,nA0]=binning(A0,binsizeA0,beginA0,endA0);

beginA=0;   % fit one gauss
binsizeA=2.1;
endA=50;
[cA,nA]=binning(A4,binsizeA,beginA,endA);
% bar(cA,nA,'LineWidth',1.5,...
%     'FaceColor',[0.800000011920929 0.800000011920929 0.800000011920929],...
%     'BarWidth',1);

beginB=-0.3675;  %0.3675 fit 1 gauss
binsizeB=2.32;   %2.32
endB=70;
[cB,nB]=binning(B8,binsizeB,beginB,endB);
% cB(1:11)=[];
% nB(1:11)=[];

% bar(cB,nB,'LineWidth',1.5,...
%     'FaceColor',[0.800000011920929 0.800000011920929 0.800000011920929],...
%     'BarWidth',1);


beginC=0.75;   %fit 3 gauss
binsizeC=2.27;
endC=60;
[cC,nC]=binning(C15,binsizeC,beginC,endC);
% nC(17)=0.025;
% nC(18)=0.01;
% nC(19)=0.0;
% nC(7)=0.02;
% nC(8)=0.025;

% bar(cC,nC,'LineWidth',1.5,...
%     'FaceColor',[0.800000011920929 0.800000011920929 0.800000011920929],...
%     'BarWidth',1);
igC=[0.076140751617991 34 1.86279907734855 0.0705017032358352 26 1.63808946575628 0.05 18 2.93273547792784];
% [aC centerC stdC]=fit3gauss(cC,nC,igC);

beginD=1.392;   %fit 4 gauss
binsizeD=2.16;
endD=70;
[cD,nD]=binning(D30,binsizeD,beginD,endD);
% bar(cD,nD,'LineWidth',1.5,...
%     'FaceColor',[0.800000011920929 0.800000011920929 0.800000011920929],...
%     'BarWidth',1);
igD=[0.0629270046745775 34 2.18299734475128 0.0584322186263934 26 2.32272690941337 0.0347049514739125 18 3.47604713591033 0.0293293155210269 10 4.11793418693185];
% [aD centerD stdD]=fit4gauss(cD,nD,igD);


beginE=-0.68;  %fit 4 gauss
binsizeE=2.06;
endE=50;
[cE,nE]=binning(E60,binsizeE,beginE,endE);
% bar(cE,nE,'LineWidth',1.5,...
%     'FaceColor',[0.800000011920929 0.800000011920929 0.800000011920929],...
%     'BarWidth',1);
igE=[0.0762829403606103 33.61 3.942 0.0418034731452449 24.92 2.222 0.041608874362796 14.65 2.183 0.0346082029118215 7.667 2.861];

% [aE centerE stdE]=fit4gauss(cE,nE,igE);
% allc=[cA cB cC cD cE];
% alln=[nA nB nC nD nE];
% [allcenter coeff]=gfitfig2(cA,nA,cB,nB,cC,nC,cD,nD,cE,nE,[34.79 2.68 3.2 3.53 25 1.99 15 1.48 3.24 2.17 3.94 7.1 1.79 2.78 1.56 1.55 2.022 0.5 0.3 0.3 0.1 0.1 0.35 0.1 0.2]);
% [allcenter coeff]=gfitfig2(cA,nA,cB,nB,cC,nC,cD,nD,cE,nE,[34.79 25.5 15 0.4 0.2 13.8 0.3 0.1 0.1 0.3 0.2 0.18]);
[allcenter coeff]=gfitfig2(cA0,nA0,cA,nA,cB,nB,cC,nC,cD,nD,cE,nE,[33.42 25.0 14 0.7 0.2 9.8 0.3 0.15 0.2 0.3 0.1 0.2]);


p=coeff;
y=@(x,xm,sd) 1/sd/sqrt(2*pi)*exp(-(x-xm).^2/2/sd^2);
xx=[0:0.1:55];


% 
% figure
% bar(cA,nA,'LineWidth',1.5,...
%     'FaceColor',[0.800000011920929 0.800000011920929 0.800000011920929],...
%     'BarWidth',1);
% hold on 
% plot(xx,y(xx,p(1),p(2)))
% ftype(1)
% 
% figure
% bar(cB,nB,'LineWidth',1.5,...
%     'FaceColor',[0.800000011920929 0.800000011920929 0.800000011920929],...
%     'BarWidth',1);
% hold on 
% plot(xx,y(xx,p(1),p(3)))
% ftype(1)
% 
% figure
% bar(cC,nC,'LineWidth',1.5,...
%     'FaceColor',[0.800000011920929 0.800000011920929 0.800000011920929],...
%     'BarWidth',1);
% hold on 
% plot(xx,p(18)*y(xx,p(1),p(4)))
% plot(xx,p(19)*y(xx,p(5),p(6)))
% plot(xx,(1-p(18)-p(19))*y(xx,p(7),p(8)))
% ftype(1)
% 
% figure
% bar(cD,nD,'LineWidth',1.5,...
%     'FaceColor',[0.800000011920929 0.800000011920929 0.800000011920929],...
%     'BarWidth',1);
% hold on 
% plot(xx,p(20)*y(xx,p(1),p(9)))
% plot(xx,p(21)*y(xx,p(5),p(10)))
% plot(xx,p(22)*y(xx,p(7),p(11)))
% plot(xx,(1-p(20)-p(21)-p(22))*y(xx,p(12),p(13)))
% ftype(1)


figure
bar(cA0,nA0*binsizeA0,'LineWidth',1.5,...
    'FaceColor',[0.800000011920929 0.800000011920929 0.800000011920929],...
    'BarWidth',1);
hold on 
plot(xx,binsizeA0*y(xx,p(1),3.3),'LineWidth',1)
ftype(1)


figure
bar(cA,nA*binsizeA,'LineWidth',1.5,...
    'FaceColor',[0.800000011920929 0.800000011920929 0.800000011920929],...
    'BarWidth',1);
hold on 
plot(xx,binsizeA*y(xx,p(1),2.68),'LineWidth',1)
ftype(1)

figure
bar(cB,nB*binsizeB,'LineWidth',1.5,...
    'FaceColor',[0.800000011920929 0.800000011920929 0.800000011920929],...
    'BarWidth',1);
hold on 
plot(xx,binsizeB*y(xx,p(1),3.198),'LineWidth',1)
ftype(1)

figure
bar(cC,nC*binsizeC,'LineWidth',1.5,...
    'FaceColor',[0.800000011920929 0.800000011920929 0.800000011920929],...
    'BarWidth',1);
hold on 
plot(xx,binsizeC*p(4)*y(xx,p(1),4.555),'LineWidth',0.5)
plot(xx,binsizeC*p(5)*y(xx,p(2),1.835),'LineWidth',0.5)
plot(xx,binsizeC*(1-p(4)-p(5))*y(xx,p(3),2.102),'LineWidth',0.5)
plot(xx,binsizeC*(p(4)*y(xx,p(1),4.555)+p(5)*y(xx,p(2),1.835)+(1-p(4)-p(5))*y(xx,p(3),2.102)),'LineWidth',1)


ftype(1)

figure
bar(cD,nD*binsizeD,'LineWidth',1.5,...
    'FaceColor',[0.800000011920929 0.800000011920929 0.800000011920929],...
    'BarWidth',1);
hold on 
plot(xx,binsizeD*p(7)*y(xx,p(1),3.244),'LineWidth',0.5)
plot(xx,binsizeD*p(8)*y(xx,p(2),2.172),'LineWidth',0.5)
plot(xx,binsizeD*p(9)*y(xx,p(3),3.942),'LineWidth',0.5)
plot(xx,binsizeD*(1-p(7)-p(8)-p(9))*y(xx,p(6),1.792),'LineWidth',0.5)
plot(xx,binsizeD*(p(7)*y(xx,p(1),3.244)+p(8)*y(xx,p(2),2.172)+p(9)*y(xx,p(3),3.942)+(1-p(7)-p(8)-p(9))*y(xx,p(6),1.792)),'LineWidth',1)

ftype(1)

figure
bar(cE,nE*binsizeE,'LineWidth',1.5,...
    'FaceColor',[0.800000011920929 0.800000011920929 0.800000011920929],...
    'BarWidth',1);
hold on 
plot(xx,binsizeE*p(10)*y(xx,p(1),2.789),'LineWidth',0.5)
plot(xx,binsizeE*p(11)*y(xx,p(2),1.569),'LineWidth',0.5)
plot(xx,binsizeE*p(12)*y(xx,p(3),1.556),'LineWidth',0.5)
plot(xx,binsizeE*(1-p(10)-p(11)-p(12))*y(xx,p(6),2.022),'LineWidth',0.5)
plot(xx,binsizeE*(p(10)*y(xx,p(1),2.789)+p(11)*y(xx,p(2),1.569)+p(12)*y(xx,p(3),1.556)+(1-p(10)-p(11)-p(12))*y(xx,p(6),2.022)),'LineWidth',1)
ftype(1)


coeff
