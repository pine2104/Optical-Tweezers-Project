clc;clear;close all


A3c1=[22.84492
16.62465
21.08151
19.88352
22.86515
16.58989
23.90947
18.1
34.2
16.35246
31.25344
16.40875
33.13703
33.31905
42.06868
27.47928
18.61112
27.47928
16.95285
26.48413
18.14669
21.13142
23.38594
36.25986
30.94596
19.5475
30.82494
22.33454
28.93085
21.32813
35.83943
19.88294
23.65917
17.77271
24.22402
37.30294
22.87838
38.65867
22.91581
38.8884
23.69165
23.01156
16.45241
24.75123
19.45852
24.27367
22.74124
14.36189
21.36645
20.78241
23.60853
30.76166
41.08328
23.23329
17.66927
23.91196
18.42721
22.17022
24.88464
37.92566
15.46299
24.72174
23.43004
17.88282
24.52449
20.90518
40.63224
24.65252
35.74212
24.13248
37.04145
23.69901
18.50925
23.43052
37.80134
21.93845
38.11187
22.83725
21.83082
16.49934
6.51761
27.68872
20.98797
12.982
32.44878
22.92254
14.46029
19.48721
29.90408
11.74453
31.20064
10.61537
5.17652
14.08249
25.14461
30.42215
12
17.7745
23.21453
15.5
21
15
21.41887
21.60461
12.68946
15.38452
20.48639
32.50155
26.07744
21.1313
];

A4=[32.17858
4.87315
33.25684
29.8876
28.22776
11.66213
28.31613
27.05302
32.65954
31.26101
30.04281
27.79307
30.17851
12.63443
31.23648
24.08874
29.44828
13.76384
31.47515
29.202
30.81761
35.07191
33.21265
32.78127
32.59692
31.44705
34.46977
33.39117
31.57077
32.44709
32.64616
34.4457
33.27519
32.94071
8.54881
39.00644
36.46728
33.72923
32.06457
30.13497
30.78711
34.54789
31.94447
32.40095
29.51936
37.22699
29.07156
28.43447
34.20378
15.5308
32.61575
33.95504
32.49934
34.63769
32.42983
36.48394
35.81439
22.59146
35.48829
27.86295
33.2631
17.78917
36.26729
33.381
28.31867
32.94046
35.35017
33.00805
34.56382
37.08896
32.93612
34.1222
31.00645
34.87901
37.89157
38.41611];
B8=[32.14729
30.33831
33.04008
10.42548
37.25615
27.24004
32.29119
29.57201
30.4674
34.73556
32.99701
5.82871
32.12509
32.61446
31.99612
32.07485
5.14274
22.25079
31.27477
30.49599
32.53039
32.04201
36.71578
30.73811
32.54413
29.88707
32.36697
31.15716
16.08508
30.59429
12.62868
27.03851
31.46671
33.27973
31.05916
27.77611
28.36022
30.78057
34.59851
33.5686
26.27272
9.64198
37.33996
36.43256
31.47303
31.75491
10.35871
29.5378
6.78209
6.78209
35.59268
11.54098
32.81665
33.49591
24.42003
30.10892
37.6
14.34034
36.58017
33.45887
22.10884
32.84028
32.59774
32.31602
28.70675
8.93954
32.3094
9.47526
14.59226
35.04683
35.83929
28.28986
33.36905
39.05531
33.80779
33.12132
32.52416
41.55808
33.84777
36.27208
37.72846
36.82869
36.54247
19.53422
43.26026
37.25005
32.17856
36.55509
19.34171
35.05111
36.58242
37.09452
31.42158
38.03298
19.50928
36.7983
35.06888
41.22511
18.96405
35.72519
19.10753
36.32269
26.97095
33.48415
32.77649
29.16689
33.02458
29.8853
33.44425
27.46355
28.34758
31.77097
32.30991
34.70453
31.61501
30.98258
31.75904
33.43779
8.34261
31.8437
30.87449
35.68753
32.29414
32.08522
30.88874
40.72535
37.88319
22.51838
38.57428
22.32279
22.45572
41.20189
40.51748
34.59125
22.45572];
C15=[21.71593
39.2851
21.71593
32.22795
38.63901
41.97913
39.0757
42.36368
24.37005
39.13216
38.14149
39.57635
36.28302
40.09448
39.87416
37.16256
39.92111
39.24031
22.93366
22.82097
36.80456
36.17639
24.84582
38.29287
25.08344
37.72819
33.53291
29.92341
35.15885
28.56514
38.85139
34.76047
27.69164
30.0056
31.85859
32.94581
36.5845
34.33322
34.28486
34.8597
24.42388
26.46371
32.09706
38.17942
32.59526
34.16119
35.86783
31.30253
13.8459
37.79741
38.57471
32.73514
35.36969
34.78129
40.86578
38.14564
32.60152
24.69229
34.02006
35.49072
21.28918
31.69063
30.5008
17.33056
32.46706
31.04464
15.14453
26.22654
29.62786
24.75946
31.29699
20.9808
36.95356
32.90656
34.61609
16.61487
29.44375
29.70199
26.3518
30.0627
17.9876];
D30=[32.74889
32.74889
39.25419
32.0025
35.73028
33.00702
26.69557
39.03824
14.03047
19.17081
36.8524
23.09199
8.72848
31.92218
35.51398
35.06892
41.6026
29.43319
32.6616
17.15297
36.77285
27.88852
36.11629
8.30327
31.92306
24.52167
34.01843
26.43638
24.46143
15.78192
32.31015
20.9492
17.18563
5.75519
32.23685
23.18364
18.47137
7.58945
27.98077
15.53971
32.45055
8.87054
31.22957
25.93742
29.6101
34.64777
19.95452
38.75391
24.96997
36.46812
12.01406
19.76472
8.34723
25.27411
34.34021
8.47674
32.26206
36.24105
22.38936
32.84914
21.18357
29.19197
24.65534
6.42574
7.02498
7.50678
6.17695
9.25422
8.36034
40.19391
37.13755
30.04879
21.04791
27.29826
17.16012
11.7599
7.04923
6.6517
5.65975
5.97153
8.65072
6.10378
8.73051
36.6321
7.94428
8.66156
35.04308
39.06177
28.93025
10.64588
8.79844
19.88615
36.69628
35.11492
31.88509
11.22836
35.22416
32.28443
7.71202
11.10733
7.12365
7.46229
20.93546
];
E60=[33.52582
12.24418
28
15
22.68615
24.88647
18.15929
11.31677
24.91996
14.26433
14.43262
24.3
23.44696
25.90435
31.40453
9.28632
8.90161
5.10835
35
10.35476
10.48431
5.10712
14.96708
7.88399
8.11064
7.54237
7.37761
31.06269
4.28709
7.66651
7.44362
7.6
7.57253
15
4.28403
9.18782
32.8
7.25294
7.29242
7.23618
7.53744
7.89767
7.42308
33.26282
7.37152
33.26282
12.24418
6.40863
5.86906
16.48848
11.25428
8.72061
12.87746
14
46.85675
35.6207
38.1031
35.94622
34.41466
43.67219
39.47589
35.18171
31.5694
30.97526
36.08361
43.46991
28.04662
31.18696
29.67534
17.33874];
Fs=[31.35477
34.57926
35.31543
34.76055
33.36919
31.02436
36.20332
31.89888
22.81284
35.50316
33.42323
5.06294
38.67929
31.76591
30.85956
33.17691
16.34911
13.57961
13.76521
26.26965
53.69205
29.94069
13.26678
20.79518
13.7547
13.53466
14.65515
28.87385
48.12768
54.75671
34.10654
26.58503
34.82066
34.88519
13.37915
16.7446
12.83939
13.09314
15.79412
55.4509
15.17606
60.03834
16.57278
35.96943
13.03187
13.36429
26.90946
14.76861
28.35874
12.49248
12.35908
12.38916
39.85144
12.27715
36.16989
25.71937
11.65836
11.85774
12.8383
35.42133
12.441
11.57861
11.46624
11.51844
11.50611
12.12128
12.2931
6.33103
11.15956
11.77001
11.6812
11.94764
26.66623
10.91488
11.07655
26.36825
11.73811
11.46515
35.2002
12.95285
12.4178
11.9277
23.30839
11.39881
40.23786
49.68715
12.38953
12.53018
11.50648
6.33103
22.81249
12.11511
35.75519
11.47965
11.71165
11.46189
11.25345
11.26287
11.78415
34.98741];


beginA3c1=2.56;   
binsizeA3c1=2.21;
endA3c1=60;
[cA3c1,nA3c1]=binning(A3c1,binsizeA3c1,beginA3c1,endA3c1);
igA3c1=[0.0987248046071575 38 0.91339737991136 0.0655334008927328 32 1.28574871205955 0.0452483855992113 25 2.09246198018104 0.0287947346770876 17 2.68087638263273];
[fA3c1 centerA3c1 stdA3c1]=fit4gauss3c1(cA3c1,nA3c1,igA3c1);


beginA=0;   % fit 2 gauss
binsizeA=2.1;
endA=50;
[cA,nA]=binning(A4,binsizeA,beginA,endA);
igA=[0.144110275689223 38 1.82359751758746 0.0494091693248253 32 3.26736005789591];
[fA centerA stdA]=fit2gauss2a(cA,nA,igA);


beginB=-0.3675;  %0.3675 fit 2 gauss
binsizeB=2.32;   %2.32
endB=70;
[cB,nB]=binning(B8,binsizeB,beginB,endB);
igB=[0.0989782886334611 38 2.2120621038951 0.0532589394711353 33 3.33860706349251];
[fB centerB stdB]=fit2gauss(cB,nB,igB);


beginC=0.75;   %fit 4 gauss
binsizeC=2.27;
endC=60;
[cC,nC]=binning(C15,binsizeC,beginC,endC);
igC=[0.0632 37.83 3.5 0.05584 32.12 3.6 0.03221 24.19 3.5 0.0106 15.89 3.5]
[fC centerC stdC]=fit4gauss2c(cC,nC,igC);

beginD=1.392;   %fit 5 gauss
binsizeD=2.16;
endD=70;
[cD,nD]=binning(D30,binsizeD,beginD,endD);


 igD=[0.0629270046745775 38 1.74639787580102 0.0584322186263934 32 1.87006360617937 0.0385469718386968 24 3.23314898046635 0.0358198089965644 17 2.10142191843211 0.0269687162753856 8 1.59735843043843];
 [fD centerD stdD]=fit5gauss(cD,nD,igD);

beginE=-0.68;  %fit 5 gauss
binsizeE=2.06;
endE=50;
[cE,nE]=binning(E60,binsizeE,beginE,endE);

igE=[0.0762829403606103 38 1.63285140807511 0.0538173607724691 35 2.06546419511986 0.0416088765603329 27 13.8240465368688 0.0370853743664213 18 0.661093133043217 0.0169621317274209 9 1.20693585686677];
[fE centerE stdE]=fit5gauss(cE,nE,igE);


beginFs=0;   % fit 4 gauss
binsizeFs=2.058;
endFs=70;
[cFs,nFs]=binning(Fs,binsizeFs,beginFs,endFs);
igFs=[0.1312 38 1.67167875402716 0.063502182465833 32 2.31568149097373 0.0437 25 1.80148606083763 0.0270144909908264 12 2.8724371149746];
[fFs centerFs stdFs]=fit4gauss5f(cFs,nFs,igFs);



gstd=[stdA stdB stdC stdD stdE stdA3c1 stdFs];
gf=[fA fB fC fD fE fA3c1 fFs];
igallcenter=[39.8 30 25 8 7.7];
[allcenter coeff]=gfitfig22(cA,nA,cB,nB,cC,nC,cD,nD,cE,nE,cA3c1,nA3c1,cFs,nFs,igallcenter,gstd,gf);


p=allcenter;
y=@(x,xm,sd) 1/sd/sqrt(2*pi)*exp(-(x-xm).^2/2/sd^2);
xx=[0:0.1:55];



figure
bar(cA,nA*binsizeA,'LineWidth',1.5,...
    'FaceColor',[0.800000011920929 0.800000011920929 0.800000011920929],...
    'BarWidth',1);
hold on 
plot(xx,binsizeA*fA(1)*y(xx,p(1),stdA(1)),'LineWidth',1)
plot(xx,binsizeA*fA(2)*y(xx,p(2),stdA(2)),'LineWidth',1)
plot(xx,binsizeA*(fA(1)*y(xx,p(1),stdA(1))+fA(2)*y(xx,p(2),stdA(2))),'LineWidth',1)
ftype(1)
hold off


figure
bar(cB,nB*binsizeB,'LineWidth',1.5,...
    'FaceColor',[0.800000011920929 0.800000011920929 0.800000011920929],...
    'BarWidth',1);
hold on 
plot(xx,binsizeB*fB(1)*y(xx,p(1),stdB(1)),'LineWidth',1)
plot(xx,binsizeB*fB(2)*y(xx,p(2),stdB(2)),'LineWidth',1)
plot(xx,binsizeB*(fB(1)*y(xx,p(1),stdB(1))+fB(2)*y(xx,p(2),stdB(2))),'LineWidth',1)
hold off
ftype(1)


figure
bar(cC,nC*binsizeC,'LineWidth',1.5,...
    'FaceColor',[0.800000011920929 0.800000011920929 0.800000011920929],...
    'BarWidth',1);
hold on 
plot(xx,binsizeC*fC(1)*y(xx,p(1),stdC(1)),'LineWidth',0.5)
plot(xx,binsizeC*fC(2)*y(xx,p(2),stdC(2)),'LineWidth',0.5)
plot(xx,binsizeC*fC(3)*y(xx,p(3),stdC(3)),'LineWidth',0.5)
plot(xx,binsizeC*fC(4)*y(xx,p(4),stdC(4)),'LineWidth',0.5)
plot(xx,binsizeC*(fC(1)*y(xx,p(1),stdC(1))+fC(2)*y(xx,p(2),stdC(2))+fC(3)*y(xx,p(3),stdC(3))+fC(4)*y(xx,p(4),stdC(4))),'LineWidth',1)
ftype(1)
hold off


figure
bar(cD,nD*binsizeD,'LineWidth',1.5,...
    'FaceColor',[0.800000011920929 0.800000011920929 0.800000011920929],...
    'BarWidth',1);
hold on 
plot(xx,binsizeD*fD(1)*y(xx,p(1),stdD(1)),'LineWidth',0.5)
plot(xx,binsizeD*fD(2)*y(xx,p(2),stdD(2)),'LineWidth',0.5)
plot(xx,binsizeD*fD(3)*y(xx,p(3),stdD(3)),'LineWidth',0.5)
plot(xx,binsizeD*fD(4)*y(xx,p(4),stdD(4)),'LineWidth',0.5)
plot(xx,binsizeD*fD(5)*y(xx,p(5),stdD(5)),'LineWidth',0.5)
plot(xx,binsizeD*(fD(1)*y(xx,p(1),stdD(1))+fD(2)*y(xx,p(2),stdD(2))+fD(3)*y(xx,p(3),stdD(3))+fD(4)*y(xx,p(4),stdD(4))+fD(5)*y(xx,p(5),stdD(5))),'LineWidth',1)
ftype(1)
hold off


figure
bar(cE,nE*binsizeE,'LineWidth',1.5,...
    'FaceColor',[0.800000011920929 0.800000011920929 0.800000011920929],...
    'BarWidth',1);
hold on 
plot(xx,binsizeE*fE(1)*y(xx,p(1),stdE(1)),'LineWidth',0.5)
plot(xx,binsizeE*fE(2)*y(xx,p(2),stdE(2)),'LineWidth',0.5)
plot(xx,binsizeE*fE(3)*y(xx,p(3),stdE(3)),'LineWidth',0.5)
plot(xx,binsizeE*fE(4)*y(xx,p(4),stdE(4)),'LineWidth',0.5)
plot(xx,binsizeE*fE(5)*y(xx,p(5),stdE(5)),'LineWidth',0.5)
plot(xx,binsizeE*(fE(1)*y(xx,p(1),stdE(1))+fE(2)*y(xx,p(2),stdE(2))+fE(3)*y(xx,p(3),stdE(3))+fE(4)*y(xx,p(4),stdE(4))+fE(5)*y(xx,p(5),stdE(5))),'LineWidth',1)
ftype(1)
hold off


figure
bar(cA3c1,nA3c1*binsizeA3c1,'LineWidth',1.5,...
    'FaceColor',[0.800000011920929 0.800000011920929 0.800000011920929],...
    'BarWidth',1);
hold on 
plot(xx,binsizeC*fA3c1(1)*y(xx,p(1),stdA3c1(1)),'LineWidth',0.5)
plot(xx,binsizeC*fA3c1(2)*y(xx,p(2),stdA3c1(2)),'LineWidth',0.5)
plot(xx,binsizeC*fA3c1(3)*y(xx,p(3),stdA3c1(3)),'LineWidth',0.5)
plot(xx,binsizeC*fA3c1(4)*y(xx,p(4),stdA3c1(4)),'LineWidth',0.5)
plot(xx,binsizeC*(fA3c1(1)*y(xx,p(1),stdA3c1(1))+fA3c1(2)*y(xx,p(2),stdA3c1(2))+fA3c1(3)*y(xx,p(3),stdA3c1(3))+fA3c1(4)*y(xx,p(4),stdA3c1(4))),'LineWidth',1)
ftype(1)
hold off


figure
bar(cFs,nFs*binsizeFs,'LineWidth',1.5,...
    'FaceColor',[0.800000011920929 0.800000011920929 0.800000011920929],...
    'BarWidth',1);
hold on 
plot(xx,binsizeFs*fFs(1)*y(xx,p(1),stdFs(1)),'LineWidth',0.5)
plot(xx,binsizeFs*fFs(2)*y(xx,p(2),stdFs(2)),'LineWidth',0.5)
plot(xx,binsizeFs*fFs(3)*y(xx,p(3),stdFs(3)),'LineWidth',0.5)
plot(xx,binsizeFs*fFs(4)*y(xx,p(4),stdFs(4)),'LineWidth',0.5)
plot(xx,binsizeFs*(fFs(1)*y(xx,p(1),stdFs(1))+fFs(2)*y(xx,p(2),stdFs(2))+fFs(3)*y(xx,p(3),stdFs(3))+fFs(4)*y(xx,p(4),stdFs(4))),'LineWidth',1)
ftype(1)
hold off


coeff